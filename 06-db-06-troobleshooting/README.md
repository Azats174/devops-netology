# Домашнее задание к занятию "06-db-06-troobleshooting"

# 1. Mongodb

Определим текущую операцию командой:  
       db.currentOp()
Завершим операцию по  полученному  opid
       db.killOp()

Чтобы не было долгих запросов, необходимо постороить/перестроить соответствующий индекс

# 2. Redis
Прочитал еще раз  документацию. Из  нее  я  понял  что  наблюдаеться  проблема с 
Latency generated by expires.  Нужно очистить  просроченные  записи.
Это можно сделать  двумя  путями
Redis evict expired keys in two ways:

    One lazy way expires a key when it is requested by a command, but it is found to be already expired.
    One active way expires a few keys every 100 milliseconds.

# 3. Mysql

Исходя  из  ошибки предпологаю  что  проблема с  нехваткой ресурсов на сервере и сетевыми  проблемами.
Нужно добавить ресурсов на сервере, увеличить размер пакета max_allowed_packet, увеличить таймаут на сервере  исходя  из  имеющихся  значении. 
```
connect_timeout
net_read_timeout
wait_timeout
interactive_timeout
```
На клиенте также  увеличить таймаут connect_timeout, wait_timeout ,interactive_timeout.

# 4. Postgresql

Причина в нехватке оперативной памяти,  и ОС  убивает процессы утилизирующие память, что видно из ошибок.
Необходимо увеличить объем ОЗУ и выставить ограничение в настройках PG на использование ресурсов хоста, 
чтобы исключить потребление всех ресурсов на машине.
Или отключить  `OOM-Killer`.
Можно добавить swap память.
Возможно провести  тюнинг файловой  системы. 

